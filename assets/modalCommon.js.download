const FormParser={containerSelector:"",formSelector:"",stepSelector:"",submitUrl:"",init:function(e){let n=extractDataFromArray(e,["submitUrl"],"");n!=""&&FormParser.setSubmitUrl(n);let s=extractDataFromArray(e,["containerSelector"],"");s!=""&&FormParser.setContainerSelector(s);let o=extractDataFromArray(e,["formSelector"],"");o!=""?FormParser.setFormSelector(o):FormParser.setFormSelector(FormParser.containerSelector+" form");let t=extractDataFromArray(e,["stepSelector"],"");t!=""?FormParser.setStepSelector(t):(t=typeof $(FormParser.formSelector).attr("stepSelector")!="undefined"?$(FormParser.formSelector).attr("stepSelector"):"",t!=""&&FormParser.setStepSelector(FormParser.formSelector+" "+t)),FormParser.stepSelector!=""&&FormParser.setupHtmlForSteps()},setSubmitUrl:function(e){typeof e=="undefined"&&(FormParser.submitUrl=e)},setupHtmlForSteps:function(e){typeof e=="undefined"&&(e=FormParser.stepSelector),console.log(FormParser.formSelector,FormParser.stepSelector);let t=0,n=$(e).length;$(e).each(function(){let n=typeof $(this).attr("hideNextPrev")!="undefined"?$(this).attr("hideNextPrev").toLowerCase():"",i=n!=""&&(n.indexOf("all")>=0||n.indexOf("next")>=0)?1:0,a=n!=""&&(n.indexOf("all")>=0||n.indexOf("prev")>=0)?1:0,s="",o="";i||(s=FormParser._getButtonHtml(this,"next",{class:"btn btn-primary",onClick:`FormParser.showNextSection('${e}', ${t});return false;`})),!a&&t!=0&&(o=FormParser._getButtonHtml(this,"prev",{class:"btn btn-light",onClick:`FormParser.showPrevSection('${e}', ${t});return false;`}));let r=`<div class='nextPrevButtons' style="display:flex;justify-content: space-between;direction: rtl;">${s}${o}</div>`;$(this).append(r),t>0&&$(this).hide(),++t})},_getButtonHtml:function(e,t="next",n={text:"",onClick:"FormParser.showNextSection(this);return false;",class:"btn btn-primary",style:""}){if(typeof e=="undefined")return"";n.text=typeof $(e).attr(t+"ButtonText")!="undefined"?$(e).attr(t+"ButtonText"):typeof n.text!="undefined"?n.text:"",n.onClick=typeof $(e).attr(t+"ButtonOnClick")!="undefined"?$(e).attr(t+"ButtonOnClick"):typeof n.onClick!="undefined"?n.onClick:"",n.class=typeof $(e).attr(t+"ButtonClass")!="undefined"?$(e).attr(t+"ButtonClass"):typeof n.class!="undefined"?n.class:"",n.style=typeof $(e).attr(t+"ButtonStyle")!="undefined"?$(e).attr(t+"ButtonStyle"):typeof n.style!="undefined"?n.style:"",n.text==""&&(n.text=t.charAt(0).toUpperCase()+t.slice(1));let s=`<button type="button" class="${n.class}" onClick="${n.onClick.replaceAll('"','"')}" style="${n.style}" >${n.text}</button>`;return s},setContainerSelector:function(e){typeof e!="undefined"&&(FormParser.containerSelector=e)},setFormSelector:function(e){typeof e!="undefined"&&(FormParser.formSelector=e)},setStepSelector:function(e){typeof e!="undefined"&&(FormParser.stepSelector=e)},showNoticeMsg:function(){},showNextSection:function(e,t){let n=FormParser.validateFields(e+`:eq(${t})`);FormParser._isValid(n)&&($(e).eq(t).next().show(),$(e).eq(t).hide())},showPrevSection:function(e,t){console.log(e),$(e).eq(t).prev().show(),$(e).eq(t).hide()},validateFields:function(e,t=!1){if(typeof e=="undefined")return showModalErrorMsg(FormParser.containerSelector+" #errorMsg","Invalid action, there is some issue with the configuration, please contact support team."),!1;setListnerClearModalMsgOnInputChange(e);let o={},i={};var n=!0,s={radio:{},checkbox:{}};if($(e+" *").filter(":input").each(function(){let f=typeof $(this).attr("validation")!="undefined"?$(this).attr("validation"):"",d=f.toLowerCase(),c=d.split(","),l=typeof $(this).attr("type")!="undefined"?$(this).attr("type"):"",a=typeof $(this).attr("id")!="undefined"?$(this).attr("id"):"",h=typeof $(this).attr("label")!="undefined"?$(this).attr("label"):"",r=typeof $(this).attr("name")!="undefined"?$(this).attr("name"):"",u=typeof $(this).attr("errormsg")!="undefined"?$(this).attr("errormsg"):"",m=typeof $(this).attr("warpperid")!="undefined"?$(this).attr("warpperid"):"",e="";if(l=="checkbox"||l=="radio"){if(c.includes("required")&&extractDataFromArray(s,[l,r],"")==""){let e=typeof $(this).attr("errormsg")!="undefined"?$(this).attr("errormsg"):"";s[l][r]={wrapperId:m,errorMsg:e,id:a,count:0}}if($(this).is(":checked"))e=trim($(this).val()),e!=""&&(s[l][r]={wrapperId:m,errorMsg:u,id:a,count:extractDataFromArray(s,[l,r,"count"],0)+1});else return!0}else e=trim($(this).val());if(t){let t=a!=""?a:r;o[t]=e,i[t]={name:r,val:e}}if(c.includes("required")&&e==""){let e=empty(u)?h+" is required":u;return showModalErrorMsg(FormParser.containerSelector+" #errorMsg",e,FormParser.containerSelector+" #"+a),n=!1,!1}if(e!=""){if(c.includes("name")&&!e.match(/[A-Zaz]/i))return showModalErrorMsg(FormParser.containerSelector+" #errorMsg",h+" can not be empty or numeric",FormParser.containerSelector+" #"+a),n=!1,!1;if(c.includes("email")&&!isValidEmailAddress(e))return showModalErrorMsg(FormParser.containerSelector+" #errorMsg","Invalid email",FormParser.containerSelector+" #"+a),n=!1,!1;if(c.includes("workmail")){if(!isValidEmailAddress(e))return showModalErrorMsg(FormParser.containerSelector+" #errorMsg","Invalid email",FormParser.containerSelector+" #"+a),n=!1,!1;if(!isOfficialEmail(e))return showModalErrorMsg(FormParser.containerSelector+" #errorMsg","Your work domain's email is required",FormParser.containerSelector+" #"+a),n=!1,!1}if(d.indexOf("passlen")>=0){let s=d.match(/passlen([0-9]+)/),t=typeof s!="undefined"?s[1]:0;if(t>0&&e.length<t)return showModalErrorMsg(FormParser.containerSelector+" #errorMsg","Entered password length must be at least "+t+" characters.",FormParser.containerSelector+" #"+a),n=!1,!1}if(c.includes("strongpass")&&!validatePassword(e))return showModalErrorMsg(FormParser.containerSelector+" #errorMsg",getPasswordNotStrongEnoughMsg(),FormParser.containerSelector+" #"+a),n=!1,!1}}),n)for(const e in s){for(const t in s[e])if(extractDataFromArray(s[e][t],["count"],"")==0){let o=extractDataFromArray(s[e][t],["wrapperId"],""),i=extractDataFromArray(s[e][t],["id"],""),a=extractDataFromArray(s[e][t],["errorMsg"],""),r=typeof $("#"+i).attr("label")!="undefined"?$("#"+i).attr("label"):"",c=empty(a)?r+" is required":a;o==""&&(o=i),showModalErrorMsg(FormParser.containerSelector+" #errorMsg",c,FormParser.containerSelector+" #"+o,e),n=!1;break}if(!n)break}return{valid:n,data:o,dataKeyPairArr:i}},submitForm:function(e,t=null,n=null){FormParser.containerSelector=e;let s=FormParser.containerSelector+" form";typeof e!="undefined"&&(s=e),__LOADER_IMG_SHAREDEDITACCESS="/assets/images/loader.gif";let o=FormParser.validateFields(s,!0);if(FormParser._isValid(o)){let e=o.data;e.hasOwnProperty("")&&delete e[""],o.dataKeyPairArr.hasOwnProperty("")&&delete o.dataKeyPairArr[""];let i=s+" form",r=typeof $(s).attr("submitType")!="undefined"?$(s).attr("submitType"):typeof $(i).attr("submitType")!="undefined"?$(i).attr("submitType"):"post",c=typeof $(s).attr("submitUrl")!="undefined"?$(s).attr("submitUrl"):typeof $(i).attr("submitUrl")!="undefined"?$(i).attr("submitUrl"):FormParser.submitUrl;e.form_data=JSON.stringify(FormParser._cleanFormData(o.dataKeyPairArr));let l=FormParser._getUrl(c),a={url:l,data:e,success:function(e){FormParser._parseResponse(e,t,n)},error:function(e){n==null?showAlertMessage("S",empty(errorMsg)?"Something went wrong!":errorMsg):n(e)}};r!="get"&&(a.type="POST"),$.ajax(a)}},_cleanFormData:function(e){return delete e.cmd,delete e.qid,delete e.fid,delete e.suc,delete e[""],e},_parseResponse:function(e,t=null,n=null){if(hideLoader(),json=parseResponseData(e),json._parseCode){console.log(json,e);let s=getObjectData(e,["errorMsg"]),o=getObjectData(e,["errorCode"]);o!=0?n==null?showAlertMessage("S",empty(s)?"Something went wrong!":s):n(e):t==null?showAlertMessage("S","Submitted Successfully"):t(e)}},_getUrl:function(e){return getApiDomainUrl(e)},_isValid:function(e){return e!=!1&&extractDataFromArray(e,["valid"],!1)},showSuccessMsg:function(e){let t=`
        <div class="alert alert-success alert-dismissible">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <!-- strong>Success!</strong --> `+e+`
        </div>`;$(FormParser.containerSelector+" #errorMsg").html(t)},showErrorMsg:function(e){let t=`
        <div class="alert alert-danger alert-dismissible">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <!-- strong>Danger!</strong -->  `+e+`
        </div>`;$(FormParser.containerSelector+" #errorMsg").html(t)},showToastMsgOnSelector:function(e,t,n="",s=5e3){$(FormParser.containerSelector+" "+e).html(t).fadeIn(),typeof __showToastMsgOnSelectorHandle!="undefined"&&clearTimeout(__showToastMsgOnSelectorHandle),__showToastMsgOnSelectorHandle=setTimeout(function(){$(FormParser.containerSelector+" "+e).html(n).fadeOut()},s)}};function showModalSuccessMsg(e,t){if(e!=null&&e!=""&&$(e).length){let n=`
        <div class="alert alert-success alert-dismissible">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <!-- strong>Success!</strong --> `+t+`
        </div>`;$(e).html(n)}}var __timeOutHandlerList=[];function setListnerClearModalMsgOnInputChange(e){$(e+" input,"+e+" select,"+e+" textarea").unbind("keyup"),$(e+" input,"+e+" select,"+e+" textarea").unbind("change"),$(e+" input,"+e+" textarea").keyup(function(){setModalTimerForSelector(e)}),$(e+" select").change(function(){setModalTimerForSelector(e)}),$(e+" input[type=checkbox],"+e+" input[type=radio]").change(function(){setModalTimerForSelector(e)})}function setModalTimerForSelector(e){typeof __timeOutHandlerList[e]!="undefined"&&__timeOutHandlerList[e]&&clearTimeout(__timeOutHandlerList[e]),__timeOutHandlerList[e]=setTimeout(function(){$(e+" .text-danger").remove(),$(e+" #errorMsg .alert").remove()},300)}function showModalErrorMsg(e,t,n=null,s=""){if(empty(t)&&(t="Error"),e!=""&&e!=null&&$(e).length){let n=`
        <div class="alert alert-danger alert-dismissible">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <!-- strong>Danger!</strong -->  `+t+`
        </div>`;$(e).html(n)}if(typeof n!="undefined"&&n!=null&&($(n).parent().children(".text-danger").length>0&&$(n).parent().children(".text-danger").remove(),n.indexOf("termscheckbox")>-1?($(n).parent().parent().children(".text-danger").length>0&&$(n).parent().parent().children(".text-danger").remove(),$(n).parent().parent().append('<span class="text-danger" style="background-color: #ffff30;">'+t+"</span>")):s=="checkbox"||s=="radio"?$(n).parents(".qrc_form_group").length>0?($(n).parents(".qrc_form_group").find(".text-danger").length>0&&$(n).parents(".qrc_form_group").find(".text-danger").remove(),$(n).parents(".qrc_form_group").append('<span class="text-danger" style="background-color: #ffff30;">'+t+"</span>")):$(n).parent().append('<span class="text-danger" style="background-color: #ffff30;">'+t+"</span>"):$(n).parent().append('<span class="text-danger" style="background-color: #ffff30;">'+t+"</span>"),$(n).parents(".qrc_form").length)){$(n).parents(".qrc_form").find(".qrc_form_step_wrapper").hide();let t=n.match(/#/g).length,e=extractDataFromArray(n.split("#"),[t],"");if(!empty(e)){e=e.split("_");let t=extractDataFromArray(e,[e.length-3],-1),o=extractDataFromArray(e,[e.length-2],-1);(s=="checkbox"||s=="radio")&&(t=extractDataFromArray(e,[e.length-4],-1),o=extractDataFromArray(e,[e.length-3],-1)),e.length===1&&(e=$(n).data("index"),e=e.split("_"),t=extractDataFromArray(e,[0],-1),o=extractDataFromArray(e,[1],-1)),$("#form_"+t+"_"+o).length&&$("#form_"+t+"_"+o).show()}}}function showModalToastMsgOnSelector(e,t,n="",s=5e3){$(e).html(t).fadeIn(),typeof __showToastMsgOnSelectorHandle!="undefined"&&clearTimeout(__showToastMsgOnSelectorHandle),__showToastMsgOnSelectorHandle=setTimeout(function(){$(e).html(n).fadeOut()},s)}function isCaptchaRequired(e){return extractDataFromArray(e,["data","captcha"],"")!="required"||($(FormParser.containerSelector+" .qrc_form_step_wrapper:nth-last-child(2) .qrc_form_action_btn .h-captcha").length==1&&$(FormParser.containerSelector+" .qrc_form_step_wrapper:nth-last-child(2) .qrc_form_action_btn .h-captcha").remove(),$(FormParser.containerSelector+" .qrc_form_step_wrapper:nth-last-child(2) .qrc_form_action_btn").prepend('<div class="h-captcha" id="captcha" ></div>'),$(FormParser.containerSelector+" input[name=_t]").length==0&&$(FormParser.containerSelector).append('<input name="_t" type="hidden">'),$(FormParser.containerSelector+" input[name=_t]").val("#"),hcaptcha.render("captcha",{sitekey:"5a748872-cb02-48d2-8400-73e887629480",callback:captchaCallback,"error-callback":"onError"}),!1)}function captchaCallback(e){$(FormParser.containerSelector+" input[name=_t]").length==0&&$(FormParser.containerSelector).append('<input name="_t" type="hidden">'),$(FormParser.containerSelector+" input[name=_t]").val(e)}